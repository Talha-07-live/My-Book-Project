<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Panel</title>
<style>
  body{font-family:sans-serif;background:#111;color:#fff;text-align:center;padding:20px;}
  input, textarea, button{ display:block; margin:10px auto; width:80%; padding:10px; border-radius:6px; border:none; }
  button{ background:#0af; color:#000; font-weight:bold; cursor:pointer; }
  #movie-form{ display:none; }
  .link-input { width:70%; display:inline-block; margin:5px; }
  .remove-link { display:inline-block; cursor:pointer; color:#f00; margin-left:5px; }
</style>
</head>
<body>

<h1>Admin Panel</h1>

<div id="login-form">
  <input type="password" id="admin-pass" placeholder="Enter Admin Password">
  <button id="login-btn">Login</button>
</div>

<div id="movie-form">
  <input id="title" placeholder="Movie Title">
  <input id="poster" placeholder="Poster URL">
  <textarea id="description" placeholder="Description"></textarea>
  <input id="rating" placeholder="Rating (e.g., 8.5/10)">

  <div id="links-container">
    <div class="link-item">
      <input class="link-input" placeholder="Download Link">
      <span class="remove-link" onclick="this.parentNode.remove()">×</span>
    </div>
  </div>
  <button id="addLink">Add Link</button>
  <button id="addMovie">Add Movie</button>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
import { getDatabase, ref, push } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyDpiN0OV1aD709Q987PymfOOp_lcW6Hid8",
  authDomain: "my-book-project-c5a17.firebaseapp.com",
  databaseURL: "https://my-book-project-c5a17-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "my-book-project-c5a17",
  storageBucket: "my-book-project-c5a17.appspot.com",
  messagingSenderId: "422603504433",
  appId: "1:422603504433:web:e6870a7d2c57c045eb0e10",
  measurementId: "G-F763MR7FR9"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

const loginForm = document.getElementById("login-form");
const movieForm = document.getElementById("movie-form");

const ADMIN_PASS = "12345"; // Change this password

document.getElementById("login-btn").onclick = () => {
  const pass = document.getElementById("admin-pass").value;
  if(pass === ADMIN_PASS){
    loginForm.style.display = "none";
    movieForm.style.display = "block";
  }else{
    alert("Wrong Password!");
  }
}

// Add new link input
document.getElementById("addLink").onclick = () => {
  const container = document.getElementById("links-container");
  const div = document.createElement("div");
  div.classList.add("link-item");
  div.innerHTML = `<input class="link-input" placeholder="Download Link"><span class="remove-link" onclick="this.parentNode.remove()">×</span>`;
  container.appendChild(div);
}

// Add movie to Firebase
document.getElementById("addMovie").onclick = () => {
  const title = document.getElementById("title").value;
  const poster = document.getElementById("poster").value;
  const description = document.getElementById("description").value;
  const rating = document.getElementById("rating").value;

  const linkInputs = document.querySelectorAll(".link-input");
  const downloadLinks = [];
  linkInputs.forEach(input => {
    if(input.value.trim() !== "") downloadLinks.push(input.value.trim());
  });

  if(!title || !poster || !description || downloadLinks.length === 0){
    alert("Please fill Title, Poster, Description, and at least one Download Link!");
    return;
  }

  const movie = { title, poster, description, rating, downloadLinks };
  push(ref(db, 'movies'), movie);
  alert("Movie Added!");

  document.getElementById("title").value = "";
  document.getElementById("poster").value = "";
  document.getElementById("description").value = "";
  document.getElementById("rating").value = "";
  document.getElementById("links-container").innerHTML = `<div class="link-item">
      <input class="link-input" placeholder="Download Link">
      <span class="remove-link" onclick="this.parentNode.remove()">×</span>
    </div>`;
}
</script>
</body>
</html>
